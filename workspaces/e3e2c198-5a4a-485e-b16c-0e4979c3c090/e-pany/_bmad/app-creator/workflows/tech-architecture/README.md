# Tech Architecture Workflow

## 工作流概述

Tech Architecture工作流由Atlas主导，负责为MVP产品设计完整的技术架构方案。这个工作流将产品需求和设计转化为可实施的技术方案，包括系统架构设计、技术选型、接口规范和安全策略。

## 主导代理

**Atlas (Technical Architect)** 🏗️
- 专业技术架构师，精通多种技术栈
- 擅长设计可扩展和可维护的系统架构
- 平衡技术先进性与项目实际约束

## 工作流目标

- 设计可扩展、可维护的系统架构
- 进行科学的技术选型
- 生成详细的架构文档和设计图
- 制定技术实现标准和规范
- 为开发团队提供清晰的技术指导

## 工作流步骤

### 1. 初始化 (Init)
- 加载项目背景和上下文
- 确认输入文档（PRD、设计稿）
- 收集技术约束和偏好
- 确定架构设计范围

### 2. 需求分析 (Requirements Analysis)
- 分析功能性和非功能性需求
- 识别技术约束条件
- 定义性能和安全要求
- 确定可扩展性需求

### 3. 技术选型 (Technology Selection)
- 评估前端技术栈选项
- 选择后端技术框架
- 确定数据库解决方案
- 选择基础设施和部署方案

### 4. 架构设计 (Architecture Design)
- 设计系统整体架构
- 定义模块划分和职责
- 规划数据流转路径
- 设计服务间通信方式

### 5. 数据模型设计 (Data Model Design)
- 设计数据库Schema
- 定义数据实体关系
- 规划数据迁移策略
- 考虑数据一致性方案

### 6. 接口设计 (Interface Design)
- 定义RESTful API规范
- 设计API端点结构
- 规划认证授权机制
- 设计错误处理策略

### 7. 安全与性能 (Security & Performance)
- 制定安全架构方案
- 设计性能优化策略
- 规划监控和日志系统
- 定义备份和恢复方案

### 8. 文档与交付 (Documentation & Handoff)
- 生成技术架构文档
- 创建架构设计图
- 编写开发环境配置指南
- 准备实施交接文档

## 输入要求

- **产品需求文档 (PRD)** - 来自Alex的Product Definition工作流
- **用户体验设计** - 来自Luna的Design Sprint工作流
- **技术配置偏好** - 用户的技术栈偏好、代码生成级别等
- **项目约束** - 时间、预算、团队技能水平

## 输出交付物

### 核心文档
1. **系统架构文档**
   - 系统整体架构说明
   - 模块划分和职责
   - 技术选型报告
   - 架构决策记录 (ADR)

2. **架构设计图**
   - 系统架构图
   - 组件交互图
   - 数据流图
   - 部署架构图

3. **API规范文档**
   - RESTful API规范
   - 端点列表和说明
   - 请求/响应格式
   - 认证授权说明

4. **数据库设计文档**
   - ER图
   -表结构定义
   - 索引策略
   - 数据迁移脚本

5. **安全架构方案**
   - 认证授权机制
   - 数据加密方案
   - 安全防护措施
   - 合规性考虑

6. **性能优化指南**
   - 性能指标定义
   - 优化策略和方案
   - 缓存策略
   - 监控配置

7. **开发环境配置指南**
   - 依赖安装说明
   - 环境变量配置
   - 开发工具设置
   - 快速启动指南

## 技术考虑因素

### 架构原则
1. **简单性优先** - 避免过度设计
2. **可扩展性** - 为未来增长留出空间
3. **可维护性** - 清晰的代码结构和文档
4. **安全性** - 安全措施内置于设计
5. **性能与成本平衡** - 在性能和成本间找到平衡

### 技术选型标准
- 团队现有技术栈和技能
- 社区生态和支持成熟度
- 学习曲线和培训成本
- 长期维护和升级考虑
- 与现有系统集成能力

### MVP特殊考虑
- 快速开发和部署
- 最小复杂度原则
- 避免 premature optimization
- 保留重构和迭代的灵活性

## 工作流特性

### 支持的功能
- ✅ 暂停和继续
- ✅ 自动保存进度
- ✅ 状态恢复
- ✅ 分步执行
- ✅ 跨步骤参考
- ✅ Sidecar知识库访问

### Sidecar知识库

Atlas的sidecar包含以下知识资源：

#### `tech-stack-knowledge.md`
- 前端技术栈（React、Vue、Mobile）
- 后端技术栈（Node.js、Python、Java）
- 数据库技术（SQL、NoSQL）
- 云平台和基础设施
- CI/CD和DevOps工具
- MVP技术推荐

#### `architecture-patterns.md`
- 架构模式（分层、微服务、事件驱动、Serverless）
- 设计模式
- MVP架构推荐
- 安全模式
- 性能模式
- 可扩展性模式
- 错误处理和监控
- 开发最佳实践

## 与其他工作流的协作

### 前置工作流
- **Product Definition** (Alex) - 提供产品需求文档
- **Design Sprint** (Luna) - 提供用户体验设计

### 协作代理
- **Alex** - 澄清技术需求和业务逻辑
- **Luna** - 讨论前端技术需求和实现细节
- **Chen** - 确认技术战略和资源约束

### 后续工作流
- **MVP Implementation** - 基于架构实现代码
- **Project Planning** - 基于架构评估开发工作量

## 使用指南

### 开始工作流
在工作流菜单中选择 `TA` (Tech Architecture) 或使用菜单系统导航至此工作流。

### 暂停和继续
- 工作流自动保存每个步骤的状态
- 任何时候都可以退出，下次使用 `continue` 命令继续

### 输出文件
默认输出位置: `{output_folder}/tech-architecture-{project_name}.md`

### 查看进度
在输出文件的frontmatter中查看 `stepsCompleted` 和 `lastStep` 字段。

## 质量保证

### 架构质量检查清单
参见 `validation/architecture-checklist.md`:
- ✓ 系统架构完整性
- ✓ 技术选型合理性
- ✓ 接口设计一致性
- ✓ 安全措施全面性
- ✓ 性能优化有效性

### 验证规则
使用 `validation/validation-checklist.md` 进行工作流质量验证。

## 常见问题

**Q: 如何处理复杂的MVP需求？**
A: 分阶段设计，先设计MVP核心架构，为后续扩展预留接口和抽象层。

**Q: 技术选型有冲突怎么办？**
A: 优先考虑团队能力和项目约束，选择最成熟和稳定的方案，避免引入过多新技术。

**Q: 架构如何平衡复杂度和可扩展性？**
A: 应用YAGNI原则，只设计当前需要的复杂度，通过合理的抽象层为未来扩展预留空间。

**Q: 如何处理安全设计？**
A: 遵循安全内置于设计原则，在架构层面考虑认证、授权、加密、防护等安全措施。

## 状态

✅ **实现完成** - 所有步骤、模板、数据文件已创建

---

**创建日期**: 2024-01-07
**最后更新**: 2024-01-07
**版本**: 1.0.0
